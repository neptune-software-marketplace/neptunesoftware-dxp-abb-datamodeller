{
	"id": "11c1ae57-8d3d-ed11-a27c-e42aac61c092",
	"createdAt": "2022-09-26T11:21:19.920Z",
	"createdBy": "kristin.eliassen@neptune-software.com",
	"globalScripts": [],
	"externalModules": [
		{
			"id": "88CDE492-9935-ED11-A27C-E42AAC61C092",
			"name": "typeorm",
			"contextname": "typeorm",
			"path": "typeorm"
		}
	],
	"entitySets": [],
	"apis": [],
	"name": "getPackages",
	"ver": "22.9.26.1144",
	"description": null,
	"content": [
		"==OBJECT STRING==",
		"try {",
		"    const manager = modules.typeorm.getConnection().manager;",
		"    const packageData = await manager.find('package');",
		"    const tables = await manager.find('dictionary');",
		"",
		"    if (!packageData || !tables) {",
		"        result.data = 'Not found';",
		"        result.statusCode = 404;",
		"        return complete();",
		"    }",
		"",
		"    tables.forEach(table => {",
		"        const tablePackageIndex = packageData.findIndex(package => package.id === table.package);",
		"        if (tablePackageIndex === -1) {",
		"            return;",
		"        }",
		"",
		"        if (!packageData[tablePackageIndex].hasOwnProperty('tables')) {",
		"            packageData[tablePackageIndex].tables = [];",
		"        }",
		"        packageData[tablePackageIndex].tables.push(table);",
		"    });",
		"",
		"    console.log(packageData);",
		"",
		"    result = packageData;",
		"",
		"    complete();",
		"",
		"} catch (error) {",
		"    log.error('Error in request: ', error);",
		"    result = error;",
		"    return fail();",
		"}",
		"",
		"",
		""
	],
	"useAsGlobalScript": false,
	"isTypescript": false,
	"transpiledContent": null,
	"lastRunSuccessful": true,
	"jsscriptGroup": "92882a1c-dc0c-ed11-b47a-28187880d3e8",
	"package": "405a932e-033f-ed11-a27c-a04a5ebc99b7"
}